<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>View Projects ‚Äì Luminary T</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: 'Poppins', sans-serif;
      padding: 20px;
    }
    a { text-decoration: none; }

    /* Go Back Button */
    .back-btn {
      display: inline-flex;
      align-items: center;
      color: #00ff88;
      font-weight: 500;
      font-size: 1.1rem;
      margin-bottom: 20px;
      transition: 0.3s;
    }
    .back-btn:hover { color: #fff; transform: translateX(-4px); }

    /* Project Grid */
    .project-card {
      background: #111;
      border-radius: 15px;
      overflow: hidden;
      transition: all 0.4s ease;
      border: 1px solid #00ff88;
    }
    .project-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
    }
    .project-card img {
      width: 100%;
      height: 160px;
      object-fit: cover;
    }
    .project-card .card-body {
      padding: 15px;
    }
    .project-card h5 {
      color: #00ff88;
      font-weight: 600;
    }
    .project-card p {
      font-size: 0.9rem;
      color: #ccc;
    }

    /* Upload Section */
    #uploadSection {
      display: none;
      margin-top: 30px;
      background: #111;
      padding: 20px;
      border-radius: 15px;
      border: 1px solid #00ff88;
    }
    #uploadSection h4 {
      color: #00ff88;
    }

    /* Responsive Grid */
    .project-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 20px;
    }

    /* Section Titles */
    .category-title {
      color: #00ff88;
      font-weight: 700;
      margin-top: 40px;
      margin-bottom: 15px;
      border-left: 4px solid #00ff88;
      padding-left: 10px;
    }

    /* Fade-in Animation */
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.8s ease;
    }
    .fade-in.show {
      opacity: 1;
      transform: translateY(0);
    }

     :root{
    --accent:#00ff88;
    --bg:#0b0b0b;
    --panel:#101215;
    --muted:#9aa0a6;
  }
  .lt-admin-trigger { cursor: pointer; display:inline-block; }
  .lt-admin-modal {
    position:fixed; inset:0; background:rgba(2,6,10,0.7); display:none; z-index:12000;
    align-items:center; justify-content:center; padding:20px;
  }
  .lt-admin-box {
    width:420px; max-width:95%; background:linear-gradient(180deg,#071018,#0f1418);
    border:1px solid rgba(255,255,255,0.04); border-left:4px solid var(--accent); padding:22px; border-radius:12px;
    box-shadow:0 20px 60px rgba(2,8,12,0.8);
    color:#e6f2ea;
  }
  .lt-admin-box h3{ margin:0 0 10px; color:var(--accent); font-size:18px; }
  .lt-admin-box p{ color:var(--muted); margin:0 0 14px; font-size:13px }
  .lt-admin-box input[type="password"]{
    width:100%; padding:10px 12px; border-radius:8px; border:1px solid #1b2426; background:#071018; color:#fff; margin-bottom:12px;
  }
  .lt-admin-drawer {
    position:fixed; left:0; right:0; bottom:-100%; height:60vh; max-height:760px; z-index:11500;
    background:linear-gradient(180deg,#071018,#07161a); border-top:4px solid var(--accent);
    box-shadow:0 -20px 60px rgba(2,8,12,0.85); transition:bottom .45s cubic-bezier(.2,.9,.25,1);
    padding:18px 22px; overflow:auto; color:#eafaf0;
  }
  .lt-admin-drawer.open{ bottom:0; }
  .lt-admin-top { display:flex; align-items:center; justify-content:space-between; gap:12px; border-bottom:1px solid rgba(255,255,255,0.03); padding-bottom:12px; margin-bottom:12px }
  .lt-admin-title { font-weight:700; color:var(--accent); font-size:16px }
  .lt-admin-actions { display:flex; gap:8px; align-items:center }
  .lt-admin-btn {
    background:linear-gradient(90deg,var(--accent),#00d9a3); color:#001; border:none; padding:8px 12px; border-radius:8px; font-weight:700; cursor:pointer;
  }
  .lt-admin-ghost { background:transparent; border:1px solid rgba(255,255,255,0.06); padding:8px 10px; border-radius:8px; color:var(--muted); cursor:pointer }
  .lt-admin-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:12px; margin-top:14px }
  .lt-card { background:#0d1112; border-radius:8px; padding:10px; border:1px solid rgba(255,255,255,0.03); display:flex; gap:10px; align-items:center }
  .lt-thumb { width:64px; height:64px; border-radius:6px; overflow:hidden; flex-shrink:0; background:#0a0a0a; display:flex; align-items:center; justify-content:center }
  .lt-thumb img{ width:100%; height:100%; object-fit:cover; display:block }
  .lt-meta { flex:1; font-size:13px }
  .lt-meta b{ display:block; color:#fff; margin-bottom:6px }
  .lt-card .lt-actions { display:flex; gap:6px; }
  .lt-card .lt-actions button { padding:6px 8px; border-radius:6px; border:none; cursor:pointer; font-size:12px }
  .lt-delete{ background:#2b0f12; color:#ffb3b8; border:1px solid rgba(255,0,0,0.06) }
  .lt-replace{ background:#05231a; color:var(--accent); border:1px solid rgba(0,255,136,0.06) }
  .lt-add-form { display:flex; gap:8px; margin-top:14px; align-items:center }
  .lt-add-form select, .lt-add-form input[type="text"] { background:#071018; border:1px solid rgba(255,255,255,0.03); padding:8px; color:#e6f2ea; border-radius:8px; }
  .lt-note { margin-top:10px; color:var(--muted); font-size:13px }
  /* small screens */
  @media (max-width:640px){ .lt-admin-grid{ grid-template-columns:1fr } .lt-thumb{ width:78px; height:78px } }
  /* subtle animate */
  .lt-fade { opacity:0; transform:translateY(6px); animation:fadeInUp .45s forwards }
  @keyframes fadeInUp{ to{ opacity:1; transform:none } }

    .footer-section {
    background: #0a0a0a;
    color: #ccc;
    text-align: center;
    padding: 25px 10px;
    border-top: 1px solid #111;
    margin-top: 50px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  .footer-section .footer-brand {
    color: #00ff88;
    font-weight: 600;
    cursor: pointer;
    transition: color 0.3s ease;
  }
  .footer-section .footer-brand:hover {
    color: #00d9ff;
  }
  .footer-note {
    font-size: 13px;
    color: #888;
    margin-top: 5px;
  }
  </style>
</head>
<body>

  <!-- Go Back Button -->
  <a href="index.html" class="back-btn">‚Üê Go Back</a>

  <!-- E-Commerce Section -->
  <h3 class="category-title">üõí E-Commerce Projects</h3>
  <div class="project-grid">
    <div class="project-card fade-in">
      <img src="Image/gadget 1.jpg" alt="Gadget Boutique">
      <div class="card-body">
        <h5>Gadget Boutique</h5>
        <p>Modern tech gadgets and accessories store.</p>
        <a href="Image/gadget 1.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
    <div class="project-card fade-in">
      <img src="Image/fashion.jpg" alt="Fashion Hub">
      <div class="card-body">
        <h5>Fashion Hub</h5>
        <p>Trendy online clothing and accessories boutique.</p>
        <a href="Image/fashion.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
  </div>

  <!-- Business Websites -->
  <h3 class="category-title">üíº Business Websites</h3>
  <div class="project-grid">
    <div class="project-card fade-in">
      <img src="Image/luheri.jpg" alt="Luheri Consult">
      <div class="card-body">
        <h5>Luheri Consult</h5>
        <p>Professional business consulting website with modern UI.</p>
        <a href="Image/luheri.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
    <div class="project-card fade-in">
      <img src="Image/green.jpg" alt="Green Solutions">
      <div class="card-body">
        <h5>Green Solutions</h5>
        <p>Eco-friendly company website with sustainable branding.</p>
        <a href="Image/green.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
  </div>

  <!-- Landing Pages -->
  <h3 class="category-title">üé® Landing Pages</h3>
  <div class="project-grid">
    <div class="project-card fade-in">
      <img src="Image/landing 1.jpg" alt="Product Promo">
      <div class="card-body">
        <h5>Product Promo</h5>
        <p>Minimal landing page for tech product showcase.</p>
        <a href="Image/landing 1.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
    <div class="project-card fade-in">
      <img src="Image/Event Landing Page.jpg" alt="Event Launch">
      <div class="card-body">
        <h5>Event Launch</h5>
        <p>Vibrant event marketing and signup landing page.</p>
        <a href="Image/Event Landing Page.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
  </div>

   <h3 class="category-title">üåêPortfolio <h3>
  <div class="project-grid">
    <div class="project-card fade-in">
      <img src="Image/business.jpg" alt="Product Promo">
      <div class="card-body">
        <h5>Business Portfolio</h5>
        <p>Digital Marketing Showcase</p>
        <a href="Image/business.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
    <div class="project-card fade-in">
      <img src="Image/business 2.jpg" alt="Event Launch">
      <div class="card-body">
        <h5>Graphic Portfolio</h5>
        <p>Personal Portfolio</p>
        <a href="Image/business 2.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
  </div>
   <h3 class="category-title">üñºÔ∏èGraphics Design</h3>
  <div class="project-grid">
    <div class="project-card fade-in">
      <img src="Image/Graphics 2.jpg" alt="Product Promo">
      <div class="card-body">
        <h5>Product Promotion</h5>
        <p>Minimal flyer product showcase.</p>
        <a href="Image/Graphics 2.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
    <div class="project-card fade-in">
      <img src="Image/Graphics 1.jpg" alt="Event Launch">
      <div class="card-body">
        <h5>Business Graphics</h5>
        <p>Vibrant business graphics.</p>
        <a href="Image/Graphics 1.jpg" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    </div>
  </div>
  <footer class="footer-section">
  <div class="footer-container">
    <div class="footer-content">
      <p>¬© 2025 <span id="adminTrigger" class="footer-brand">Luminary Tech</span>. All rights reserved.</p>
      <p class="footer-note">Crafted with üíö by Luminary Team</p>
    </div>
  </div>
</footer>
  <script>
     let clickCount = 0;
  const adminTrigger = document.getElementById('adminTrigger');

  adminTrigger.addEventListener('click', () => {
    clickCount++;
    if (clickCount === 3) { // üëà Triple-click to open admin panel
      clickCount = 0;
      showPasswordModal(); // This calls the modal from your admin upload code
    }
    setTimeout(() => { clickCount = 0; }, 1000); // reset if not clicked fast
  });
  (function(){
    // If your footer brand text exists, wrap it with trigger or create one
    // Try to find site-brand elements or footer text - if not found we'll append a tiny trigger in footer
    function ensureTrigger(){
      // Try common selectors
      const selectors = ['.site-brand','footer .brand','footer .site-name','.brand','footer','footer .copyright'];
      let found = document.querySelector('.lt-admin-trigger');
      if(found) return;
      let target = null;
      for(const s of selectors){
        const el = document.querySelector(s);
        if(el){ target = el; break; }
      }
      if(!target){
        // fallback: append trigger to body footer area
        const f = document.createElement('div'); f.style.cssText='position:fixed;right:12px;bottom:8px;opacity:0.02;pointer-events:auto';
        f.innerHTML = '<span class="lt-admin-trigger">Luminary Tech</span>';
        document.body.appendChild(f);
        return;
      }
      // wrap brand text or append trigger after target
      const t = document.createElement('span');
      t.className = 'lt-admin-trigger';
      t.textContent = 'Luminary Tech';
      t.style.cssText = 'margin-left:8px;cursor:pointer;opacity:.9;font-weight:700';
      target.appendChild(t);
    }
    document.addEventListener('DOMContentLoaded', ensureTrigger);
  })();
</script>

<!-- Modal for password -->
<div id="ltAdminModal" class="lt-admin-modal" aria-hidden="true">
  <div class="lt-admin-box lt-fade" role="dialog" aria-modal="true">
    <h3>Admin Unlock</h3>
    <p>Double-click or click the footer brand, then enter admin password to open the dashboard.</p>
    <input id="ltAdminPwd" type="password" placeholder="Enter admin password">
    <div style="display:flex; gap:8px; justify-content:flex-end">
      <button id="ltAdminCancel" class="lt-admin-ghost">Cancel</button>
      <button id="ltAdminSubmit" class="lt-admin-btn">Unlock</button>
    </div>
  </div>
</div>

<!-- Drawer -->
<div id="ltAdminDrawer" class="lt-admin-drawer" aria-hidden="true">
  <div class="lt-admin-top">
    <div>
      <div class="lt-admin-title">Luminary Tech ‚Äî Admin Upload</div>
      <div style="font-size:12px;color:var(--muted)">Manage project screenshots ‚Äî changes apply immediately</div>
    </div>
    <div class="lt-admin-actions">
      <div id="ltAdminStatus" style="font-size:12px;color:var(--muted)"></div>
      <button id="ltAdminClose" class="lt-admin-ghost">Close</button>
      <button id="ltAdminLogout" class="lt-admin-ghost">Logout</button>
    </div>
  </div>

  <div style="display:flex; gap:14px; align-items:center; flex-wrap:wrap">
    <label class="lt-admin-ghost" style="padding:8px 10px">Replace Selected Card</label>
    <input id="ltReplaceInput" type="file" accept="image/*" style="display:none">
    <button id="ltReplaceBtn" class="lt-admin-btn">Choose Image to Replace</button>
    <button id="ltAddBtn" class="lt-admin-ghost">Add New Project</button>
    <div style="flex:1"></div>
  </div>

  <div class="lt-admin-grid" id="ltCardsContainer"></div>

  <div class="lt-add-form" id="ltAddForm" style="display:none">
    <select id="ltCategorySelect"></select>
    <input id="ltNewTitle" placeholder="Project Title (optional)" type="text">
    <input id="ltNewDesc" placeholder="Short description (optional)" type="text">
    <input id="ltNewFile" type="file" accept="image/*">
    <button id="ltNewSave" class="lt-admin-btn">Save Project</button>
    <button id="ltNewCancel" class="lt-admin-ghost">Cancel</button>
  </div>

  <div class="lt-note">Tip: Replacing or deleting updates the public gallery instantly. Data stored locally in your browser only.</div>
</div>

<script>
(function(){
  // CONFIG
  const PASSWORD = 'Qoyum747181$'; // change this if you want
  const LS_KEY = 'LoNer...D';

  // Utility
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));

  // State
  let projects = []; // {id, title, desc, imgData, containerSelector}
  let selectedReplaceId = null;

  // When DOM ready
  document.addEventListener('DOMContentLoaded', initAdmin);

  function initAdmin(){
    // Attach reveal handlers to any .lt-admin-trigger (double click)
    function attachTriggers(){
      $$('body .lt-admin-trigger').forEach(el=>{
        el.addEventListener('dblclick', openPwdModal);
        el.addEventListener('click', () => { /* single click does nothing to avoid accidental reveals */ });
      });
    }
    attachTriggers();
    // If new trigger added later, also allow manual attach (already handled in earlier ensureTrigger)

    // Hook modal buttons
    const modal = $('#ltAdminModal');
    const drawer = $('#ltAdminDrawer');
    $('#ltAdminCancel').addEventListener('click', ()=> modal.style.display='none');
    $('#ltAdminSubmit').addEventListener('click', attemptUnlock);
    $('#ltAdminClose').addEventListener('click', ()=> drawer.classList.remove('open'));
    $('#ltAdminLogout').addEventListener('click', logout);

    // Replace flow
    $('#ltReplaceBtn').addEventListener('click', ()=> {
      if(!selectedReplaceId){ alert('Select a project card below to replace its image.'); return; }
      $('#ltReplaceInput').click();
    });
    $('#ltReplaceInput').addEventListener('change', handleReplaceFile);

    // Add new project
    $('#ltAddBtn').addEventListener('click', ()=> {
      populateCategorySelect();
      $('#ltAddForm').style.display='flex';
    });
    $('#ltNewCancel').addEventListener('click', ()=> $('#ltAddForm').style.display='none');
    $('#ltNewSave').addEventListener('click', saveNewProject);

    // Load stored or map existing DOM cards
    loadOrMapExisting();
    renderCards();
  }

  // open password modal
  function openPwdModal(){
    $('#ltAdminModal').style.display='flex';
    $('#ltAdminModal').setAttribute('aria-hidden','false');
    $('#ltAdminPwd').value=''; $('#ltAdminPwd').focus();
  }

  function attemptUnlock(){
    const val = $('#ltAdminPwd').value;
    if(val === PASSWORD){
      $('#ltAdminModal').style.display='none';
      openDrawer();
      localStorage.setItem('lt_admin_unlocked','1');
    } else {
      alert('Incorrect password');
      $('#ltAdminPwd').value=''; $('#ltAdminPwd').focus();
    }
  }

  function openDrawer(){
    $('#ltAdminDrawer').classList.add('open');
    $('#ltAdminStatus').textContent = new Date().toLocaleString();
  }

  function logout(){
    localStorage.removeItem('lt_admin_unlocked');
    $('#ltAdminDrawer').classList.remove('open');
    alert('Logged out');
  }

  // Map existing .project-card elements to project entries (only first time)
  function loadOrMapExisting(){
    const stored = localStorage.getItem(LS_KEY);
    if(stored){
      projects = JSON.parse(stored);
      // ensure DOM reflects stored
      projects.forEach(p=> applyProjectToDOM(p));
      return;
    }

    // No stored data yet: map all existing .project-card nodes
    const nodes = Array.from(document.querySelectorAll('.project-card'));
    projects = nodes.map((card, idx)=>{
      // assign id if not exist
      let id = card.getAttribute('data-project-id');
      if(!id){
        id = 'ltproj_'+Date.now()+'_'+idx;
        card.setAttribute('data-project-id', id);
      }
      // take image src
      const img = card.querySelector('img');
      const a = card.querySelector('a');
      const title = card.querySelector('h5') ? card.querySelector('h5').textContent.trim() : '';
      const desc = card.querySelector('p') ? card.querySelector('p').textContent.trim() : '';
      const imgSrc = img ? img.getAttribute('src') : '';
      const containerSelector = getContainerSelector(card);
      return { id, title, desc, imgData: imgSrc, containerSelector };
    });
    saveProjects();
  }

  // get a short selector identifying the parent grid container (so new items can be appended there)
  function getContainerSelector(card){
    // prefer existing ancestor with class 'project-grid' and a preceding heading text -> create selector using heading text
    let grid = card.closest('.project-grid');
    if(!grid){
      // fallback to parent node with unique index
      const parent = card.parentElement;
      const idx = Array.from(parent.parentElement.children).indexOf(parent);
      return null;
    }
    // try to find previous heading text to label category
    let heading = null;
    let prev = grid.previousElementSibling;
    while(prev){
      if(prev.tagName.toLowerCase().startsWith('h')){ heading = prev.textContent.trim(); break; }
      prev = prev.previousElementSibling;
    }
    // use index among project-grid occurrences as reliable selector
    const grids = Array.from(document.querySelectorAll('.project-grid'));
    const gridIndex = grids.indexOf(grid);
    return '.project-grid:nth-of-type(' + (gridIndex+1) + ')' + (heading ? '|' + heading : '');
  }

  // save to LocalStorage
  function saveProjects(){
    localStorage.setItem(LS_KEY, JSON.stringify(projects));
  }

  // render admin cards list
  function renderCards(){
    const container = $('#ltCardsContainer');
    container.innerHTML = '';
    projects.forEach(p=>{
      const card = document.createElement('div');
      card.className = 'lt-card';
      card.innerHTML = `
        <div class="lt-thumb"><img src="${escapeHtml(p.imgData||'')}" alt=""></div>
        <div class="lt-meta"><b>${escapeHtml(p.title||'Untitled')}</b><div style="color:var(--muted)">${escapeHtml(p.desc||'')}</div><div style="font-size:12px;color:var(--muted);margin-top:6px">ID: ${p.id}</div></div>
        <div class="lt-actions">
          <button class="lt-replace" data-id="${p.id}">Replace</button>
          <button class="lt-delete" data-id="${p.id}">Delete</button>
        </div>
      `;
      container.appendChild(card);
    });

    // attach handlers
    container.querySelectorAll('.lt-replace').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        selectedReplaceId = e.target.getAttribute('data-id');
        $('#ltReplaceInput').click();
      });
    });
    container.querySelectorAll('.lt-delete').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        const id = e.target.getAttribute('data-id');
        if(!confirm('Delete this project? This will remove it from site and local storage.')) return;
        deleteProject(id);
      });
    });

    // also allow clicking in-page project cards to select (visual selection)
    // add click listeners to page .project-card to highlight selection in admin
    Array.from(document.querySelectorAll('.project-card')).forEach(domCard=>{
      domCard.addEventListener('click', function(){
        const id = this.getAttribute('data-project-id');
        if(!id) return;
        selectedReplaceId = id;
        // scroll admin drawer to selection
        const btn = $('#ltCardsContainer').querySelector(`[data-id="${id}"]`);
        if(btn) btn.scrollIntoView({behavior:'smooth',block:'center'});
        // brief highlight
        btn.style.outline='2px solid rgba(0,255,136,0.08)'; setTimeout(()=>btn.style.outline='',900);
        alert('Selected project for replacement: ' + id);
      });
    });
  }

  // handle replace file chosen in file input
  function handleReplaceFile(e){
    const file = e.target.files && e.target.files[0];
    if(!file) return;
    const id = selectedReplaceId;
    if(!id){ alert('No project selected.'); return; }
    const reader = new FileReader();
    reader.onload = function(evt){
      const data = evt.target.result;
      // update projects array
      const idx = projects.findIndex(p=>p.id===id);
      if(idx >= 0){
        projects[idx].imgData = data;
        saveProjects();
        applyProjectToDOM(projects[idx]);
        renderCards();
        alert('Image replaced successfully.');
      } else {
        alert('Project not found.');
      }
    };
    reader.readAsDataURL(file);
    e.target.value = '';
  }

  // delete project
  function deleteProject(id){
    const idx = projects.findIndex(p=>p.id===id);
    if(idx === -1) return;
    // remove from array
    const removed = projects.splice(idx,1)[0];
    saveProjects();
    // also remove DOM element(s) that have that data-project-id
    const doms = document.querySelectorAll(`[data-project-id="${id}"]`);
    doms.forEach(d => d.remove());
    renderCards();
    alert('Deleted.');
  }

  // apply project to DOM (update images and anchors)
  function applyProjectToDOM(p){
    // find elements that match this project by data-project-id
    let doms = document.querySelectorAll(`[data-project-id="${p.id}"]`);
    // if none, attempt to find by matching original img src (fallback)
    if(doms.length===0){
      // try to find any img with src === p.imgData (only if p.imgData is plain URL)
      if(p.imgData && !p.imgData.startsWith('data:')){
        doms = Array.from(document.querySelectorAll('img')).filter(i=> i.getAttribute('src') === p.imgData);
      }
    }
    doms.forEach(card=>{
      // update img
      const img = card.querySelector('img');
      if(img) img.src = p.imgData;
      // update anchor href
      const a = card.querySelector('a');
      if(a) a.href = p.imgData;
    });
  }

  // Add new project
  function populateCategorySelect(){
    const sel = $('#ltCategorySelect');
    sel.innerHTML = '';
    // Find all headings and project-grid pairs to let admin choose where to add
    const grids = Array.from(document.querySelectorAll('.project-grid'));
    grids.forEach((g, idx)=>{
      // heading text attempt
      let headingText = '';
      let prev = g.previousElementSibling;
      while(prev){
        if(prev.tagName.toLowerCase().startsWith('h')){
          headingText = prev.textContent.trim(); break;
        }
        prev = prev.previousElementSibling;
      }
      const label = (headingText ? headingText : `Project Grid #${idx+1}`);
      const opt = document.createElement('option');
      opt.value = '.project-grid:nth-of-type(' + (idx+1) + ')';
      opt.textContent = label;
      sel.appendChild(opt);
    });
  }

  function saveNewProject(){
    const fileInput = $('#ltNewFile');
    if(!fileInput.files[0]){ alert('Choose an image file'); return; }
    const title = $('#ltNewTitle').value || 'Untitled';
    const desc = $('#ltNewDesc').value || '';
    const containerSelector = $('#ltCategorySelect').value || null;
    const file = fileInput.files[0];
    const reader = new FileReader();
    reader.onload = function(e){
      const data = e.target.result;
      const id = 'ltproj_' + Date.now();
      const p = { id, title, desc, imgData: data, containerSelector };
      projects.push(p);
      saveProjects();
      // append DOM card to target grid
      appendProjectToDOM(p);
      renderCards();
      $('#ltAddForm').style.display='none';
      $('#ltNewFile').value=''; $('#ltNewTitle').value=''; $('#ltNewDesc').value='';
      alert('New project added.');
    };
    reader.readAsDataURL(file);
  }

  function appendProjectToDOM(p){
    const target = document.querySelector(p.containerSelector);
    if(!target){ alert('Target grid not found; project added but cannot be displayed'); return; }
    // create card HTML matching your structure
    const div = document.createElement('div');
    div.className = 'project-card fade-in';
    div.setAttribute('data-project-id', p.id);
    div.innerHTML = `
      <img src="${p.imgData}" alt="${escapeHtml(p.title)}">
      <div class="card-body">
        <h5>${escapeHtml(p.title)}</h5>
        <p>${escapeHtml(p.desc)}</p>
        <a href="${p.imgData}" class="btn btn-sm btn-outline-success">View Site</a>
      </div>
    `;
    target.appendChild(div);
    // attach click binding to enable selecting for replacement
    div.addEventListener('click', ()=> {
      selectedReplaceId = p.id;
      alert('Selected project for replacement: ' + p.id);
    });
  }

  // helper to escape potential text
  function escapeHtml(s){ return (s||'').toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

  // If admin unlocked previously, auto open
  window.addEventListener('load', ()=> {
    if(localStorage.getItem('lt_admin_unlocked')) openDrawer();
  });

})();

  
    // Fade-in animation on scroll
    const cards = document.querySelectorAll('.fade-in');
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('show');
      });
    }, { threshold: 0.2 });
    cards.forEach(card => observer.observe(card));
  </script>

</body>
</html>
